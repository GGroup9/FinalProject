---
title: "Final Project"
author: "Zhaojin Zhu"
date: "2020/11/29"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Abstract


This project discusses the factors influencing life expectancy, health factors for 193 countries based on the dataset provided by the Global Health Observatory(GHO) data repository under World Health Organization(WHO). In this project we consider data from 2000 to 2015 for 193 countries which focus on immunization factors, mortality factors, economic factors, social factors and other health related factors as well for further analysis. 
There are 22 columns and 2930 rows in the dataset file `Life Expectancy Data.csv`.

## Introduction

Nowadays people's living standards have improved significantly in many ways. For example economy, education and medical level etc. These are the factors that may have impact on our life expectancy. However, which one of the factors are the most significant or which factors only has a small impact that can be ignored? Moreover, the developed and developing countries have different living standards and social phenomenon. Is the developing country has less life expectancy than developed country or vice versa? What are the reasons for the countries that have a lower life expectancy?

We are describing the dataset by using data visualization, evaluating and fit different regression model to analyze the various factors that has impact on the life expectancy. 

## Data Description

```{r}
library(tidyverse)
library(car)
who <- read.csv(file = "Life Expectancy Data.csv", header=TRUE)

#make sure  variables are formatted properly.
str(who)


#remove Country and status
who <- who[,-c(1)]

# exclude missing values (Remove Rows with Missing Data)
complete.cases(who)
who = who[complete.cases(who),]
# 1289 observations were deleted due to missingness



#scatter plot matrix using pairs() function

#Looking at the  data
head(who)
# summary( who )

#graphical summaries
#boxplot( who , main = 'Boxplot of Life Expectancy Data' )

#fit regression model
attach(who)
model <- lm(Life.expectancy~., data = who)
summary(model)
avPlots(model)



#Residual Analysis tut 4
plot(model)

#Standardized Residuals vs. Index tut 4
plot( rstandard(model))

n <- nrow( who )
plot( model$residuals[1:(n-1)] , model$residuals[2:n])

model_influence <- influence(model)
sort(model_influence$hat, decreasing = TRUE)

model_cook <- cooks.distance(model)
sort(model_cook, decreasing = TRUE)

#Stepwise Regression using AIC
step(model, direction = 'both')
# we get a final model that has 14 out of the 20 possible predictors.
```
1289 observations were deleted due to missingness.

From the OLS summary table, we see that the p-values for predictors like percentage.expenditure, Hepatitis.B, Measles, Polio, GDP, Population, thinness 1-19 years and thinness 5-9 years are high than alpha=0.05, which mean further investigation is
needed to determine whether these predictors are significant or not in predicting the life expectancy.

Checked the diagonal of the hat matrix, only two observations have leverages higher than 0.2 , that may have the potential to be influential. However, given the large dataset, the rest of the observations have small leverages. Since none of these countries had large residuals, so we need to investigate a little more.

For our data and model, no observation has cook's distance larger than 1.

From stepwise regression, we get a final model that has 14 out of the 20 possible predictors.







## Method

The figure sizes have been customized so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```
















You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## Results

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))

## Conclusion